# 💿 AI Player: 프로젝트 과정

### 📌 목차
[1) 프로젝트 기획 및 설계](#✏️-프로젝트-기획-및-설계) <br>
[2) 데이터 수집 및 분석](#📊-데이터-수집-및-분석) <br>
[3) 모델링](#💻-모델링) <br>
[4) 서비스 구현](#🪓-서비스-구현) <br>

<br>

## ✏️ 프로젝트 기획 및 설계

### 📰 기획 배경
<img width="1000" alt="AI Player UI" src="https://github.com/pulpo125/AIPlayer_Pling/assets/118874524/f30a3219-bff3-4947-959f-6c76bbe914a7">

- 국내 음악 시장에서 유튜브의 점유율 상승 및 유튜브 내 '플레이리스트' 검색량 급증 현상을 통해 `플레이리스트 콘텐츠 수요 증가` 확인
- **SNS 콘텐츠**, **마케팅 수단**으로 활용 가능하며, 브랜드 및 음악 업계와의 협업을 통해 `경제적 가치 창출`
- 플레이리스트 제작 과정에서 가장 큰 시간이 소요되는 부분은 `기획` (곡 선정, 썸네일 제작) 단계

    ➡️ **해당 과정의 효율화를 통해 콘텐츠 생성 속도 개선하여 플레이리스트 채널의 빠른 성장을 지원할 수 있는 서비스 개발** 

<br>

### 유저 플로우
<img width="1000" alt="유저플로우" src="https://github.com/pulpo125/AIPlayer_Pling/assets/118874524/8f78c54f-f259-45e2-8757-bba8cb47bf63">

- 사용자 경험 향상을 위한 사용자 관점에서의 서비스 동작 과정 설계
- 직관적인 플로우 및 '마우스 오버' 등 명확한 정보 제공을 통한 서비스 이용 혼란 최소화

<br>

### 데이터 플로우
<img width="1000" alt="데이터플로우" src="https://github.com/pulpo125/AIPlayer_Pling/assets/118874524/985ff109-5f48-416f-b089-1466e48b0256">

- 사용자가 단 한 번의 텍스트(플레이리스트 제목) 입력을 통해 두 가지 주요 결과(플레이리스트 추천 및 썸네일 이미지)를 얻을 수 있는 간결하고 효율적인 서비스 플로우
- 사용자의 '좋아요' 버튼 클릭을 통해 수집된 피드백 데이터를 향후 **모델 재학습에 활용하여 지속적인 서비스 개선에 기여**

<br>

### 시스템 아키텍처
<img width="1000" alt="시스템설계도" src="https://github.com/pulpo125/AIPlayer_Pling/assets/130819139/e0f08865-376b-4e66-b25b-9c79f326722c">

- AWS EC2 기반 GPU 버전을 사용하여 효율적이고 확장 가능한 클라우드 컴퓨팅 환경 구축
- Django 기반의 `통합 AI 서버`를 통해 다양한 AI 모델을 하나의 시스템 내에서 운용함으로써 별도의 서버 구축 없이 **비용 효율성 극대화**

<br>

### ERD
<img width="1000" alt="ERD" src="https://github.com/pulpo125/AIPlayer_Pling/assets/118874524/a1447de6-f855-4d54-bbcc-bdbf4669788b">

- ‘song_meta’, ‘ply_meta’는 각각 음악과 플레이리스트에 대한 중요 정보를 담고 있으며 서비스의 핵심 기능인 플레이리스트 생성을 지원하도록 설계
- ‘song_in_ply’는 특정 플레이리스트에 포함된 노래들의 관계를 나타냄으로써, 플레이리스트 내용 검색 시 **빠르고 정확한 검색 가능**

<br>

## 📊 데이터 수집 및 분석

### 데이터 구조 및 선정 이유

<img width="1000" alt="데이터셋구조" src="https://github.com/pulpo125/AIPlayer_Pling/assets/118874524/486a0b11-13da-4f86-897f-85cfafc1102b">

- 카카오 아레나에서 제공한 멜론 DJ 플레이리스트 데이터셋을 수집 
- **선정 이유**
    - `품질` : 카카오에서 제공되어 신뢰도 보증
    - `적합성` : 곡 메타 정보, 장르, 플레이리스트 구성 정보 등 음악 추천 서비스를 개발할 수 있는 충분한 정보 보유
    - `다양성` : 국내 음악 플랫폼 TOP2인 ‘멜론’의 데이터로 다양한 유저의 음악 활동 정보 보유

<br>

### 데이터 특징
- 사용자는 플레이리스트의 타이틀을 보고 해당 플레이리스트의 전체적인 분위기나 테마를 이해 할 수 있음

    ➡️ 플레이리스트의 타이틀는 해당 플레이리스트의 곡과 태그의 전체적인 내용을 반영한다고 가정해, 이를 플레이리스트 추천 플로우에 활용

<br>

### EDA 및 전처리
<img width="1000" alt="데이터전처리과정" src="https://github.com/pulpo125/AIPlayer_Pling/assets/130819139/a922e911-7591-4c0c-8177-51adaa3b55ff">

- **EDA를 통해 5단계의 전처리 진행**
- 플레이리스트 추천 결과의 다양성을 위해 `Boxplot & 파레토법칙`을 활용하여 유의미한 Feature 선별
- 코드의 효율성 증대를 위해 Big-o 표기법에 따른 시간 복잡도 확인 및 차수가 낮은 `차집합 연산 코드 구성`

<br>

## 💻 모델링

### 자연어 처리 기반 추천 알고리즘
<img width="1000" alt="추천알고리즘구조도" src="https://github.com/pulpo125/AIPlayer_Pling/assets/130819139/768822c9-fcc4-4e10-b2f8-d82967bc81fc">

- 자연어 처리 기반 유사 플레이리스트 선택을 위한 `SBERT`와 해당 데이터의 패턴을 기반으로 복원하는 `Autoencoder`를 결합하여 **사용자 로그 없이 구동 가능한 협업 필터링 추천 알고리즘을 구성**하여 신규 사용자들에게도 적합한 추천이 가능

<br>

<img width="1000" alt="추천알고리즘 개발 과정" src="https://github.com/pulpo125/AIPlayer_Pling/assets/130819139/c5c93f3a-e7fb-4857-a4a5-4053b565d0c9">

- AutoEncoder 입력값을 제외한 가장 유사한 곡과 태그를 추천하여 **새로운 추천 결과 생성**
- NDCG는 추천 결과의 구성 요소와 순서를 모두 고려하는 평가 지표이므로, **확률이 높은 순으로 정렬**하여 추천 결과 생성
- 활용 가능한 자원 상태 및 **정량/정성적 결과를 종합적 고려**하여 성능 향상 진행

    ➡️ NDCG 점수 최초 대비 `약 2.5배 상승`, 카카오 경진대회 상위 10% 수준

<br>

### 썸네일 이미지 생성 모델
<img width="1000" alt="이미지생성모델 구조도" src="https://github.com/pulpo125/AIPlayer_Pling/assets/130819139/15f54b46-7523-4018-97b5-6c881e6d8151">

- 이미지 생성 모델 중 최신 모델이며 **무료 오픈소스를 통해 튜닝이 가능한**   `Stable diffusion` 활용하여 고품질 이미지를 생성
- 모델이 영어 텍스트 입력을 요구함에 따라 `Google Trans` 라이브러리를 활용하여  한국어를 영어로 번역하고 이를 모델에 적용 가능
- Stable Diffusion 튜닝(XLA, Mixed-Precision)을 통한 **속도 성능 향상 및 썸네일 이미지 규격 사이즈로 생성**

<br>

<img width="1000" alt="이미지 최적화 과정" src="https://github.com/pulpo125/AIPlayer_Pling/assets/130819139/d8a8f326-bef8-4fcc-83cc-5a59bc505914">

- 최종 프롬프트 형태: [‘Art Form(photography)’, ‘Subject(playlist title)’, ‘Details(landscape, 8K uhd)’]
- 프롬프트 엔지니어링을 통해 플레이리스트 제목과 관련된 세부 사항을 반영하여   **썸네일 이미지로써 사용성이 있는 이미지를 생성**
- 사람이 어색하게 나오는 문제 해결을 위해, `Negative Prompt`에 사람과 사람의 신체에 관한 단어 추가

<br>

## 🪓 서비스 구현
<img width="1000" alt="서비스 배포 과정" src="https://github.com/pulpo125/AIPlayer_Pling/assets/130819139/d20751d3-d741-4218-b022-9601c25adf28">

- TensorFlow 버전에 맞는 GPU 세팅이 된 EC2 구성 및 MySQL 기반 DB 생성
- venv를 활용한 가상 환경 세팅 및 Git, FTP(FileZila)를 사용한 장고 프로젝트 배포
- 24시간 중단 없는 서비스를 위한 NGINX 사용 및 Route53을 활용하여 사용자 친화적인 도메인 이름 제공
